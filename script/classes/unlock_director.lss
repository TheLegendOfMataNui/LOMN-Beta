class unlock_director {
    property filename;
    property file;
    property unlocks;

    method unlock_director() {
        this.filename = "Root/data/unlocks";
        this.file = new slosi_objectfileio(this.filename);
        if (this.file.fileexist()) {
            debug::print("Loading unlocks from file...");
            this.unlocks = this.file.loadosiobject();

            // Debug: Print the version that was loaded
            if (__isint(this.unlocks.version)) {
                debug::print("[Unlocks]: Loaded unlocks version " + __tostring(this.unlocks.version));
            }
            else {
                debug::print("[Unlocks]: Loaded legacy unlocks (v1)");
            }
        }
        else {
            debug::print("No unlocks file, loading defaults...");
            this.unlocks = new unlocks();
        }

        // Make sure the unlocks are up to date
        this.unlocks.upgrade();

        debug::print("Characters Played:");
        debug::print("Played Onua: " + __tostring(this.unlocks.played_onua));
        debug::print("Played Gali: " + __tostring(this.unlocks.played_gali));
        debug::print("Played Pohatu: " + __tostring(this.unlocks.played_pohatu));
        debug::print("Played Kopaka: " + __tostring(this.unlocks.played_kopaka));
        debug::print("Played Lewa: " + __tostring(this.unlocks.played_lewa));
        debug::print("Played Tahu: " + __tostring(this.unlocks.played_tahu));
        debug::print("Played Akamai: " + __tostring(this.unlocks.played_akamai));
        debug::print("Played Wairuha: " + __tostring(this.unlocks.played_wairuha));
        debug::print("Played Nobua: " + __tostring(this.unlocks.played_nobua));
        debug::print(" ");

        debug::print("Game Completion:");
        debug::print("Beat Makuta: " + __tostring(this.unlocks.beatkuta));
        debug::print("Beat Nobua Mode: " + __tostring(this.unlocks.beatnbua));
        debug::print("Beat Voriki Mode: " + __tostring(this.unlocks.beatviki));
        debug::print("Main Game Completion Percentage: " + __tostring(this.unlocks.maincomp));
        debug::print("Nobua Mode Completion Percentage: " + __tostring(this.unlocks.nobuacomp));
        debug::print("Collected Toa Stone Shards: " + __tostring(this.unlocks.toastone));
        debug::print("Collected Onua Print Glyph: " + __tostring(this.unlocks.printonua));
        debug::print("Collected Gali Print Glyph: " + __tostring(this.unlocks.printgali));
        debug::print("Collected Pohatu Print Glyph: " + __tostring(this.unlocks.printpoha));
        debug::print("Collected Kopaka Print Glyph: " + __tostring(this.unlocks.printkopa));
        debug::print("Collected Lewa Print Glyph: " + __tostring(this.unlocks.printlewa));
        debug::print("Collected Tahu Print Glyph: " + __tostring(this.unlocks.printtahu));    
        debug::print("Memes: " + __tostring(this.unlocks.memes));            
        debug::print(" ");
    }

    method save() {
        this.file.saveosiobject(this.unlocks);
    }
}