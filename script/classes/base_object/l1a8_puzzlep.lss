class l1a8_puzzlep : base_object {
    property parent;
    property plataarray;
    property platbarray;
    property platcarray;
    
    method l1a8_puzzlep(param1) {
        this.parent = param1;
        return null;
    }
    
    method initfull() {
        var var1;
        var var2;
        gcareadirector::setfog(-16777216, 0 - 1.0, 0 - 200.0, 0.05);
        gclightdirector::setcavelighting(0);
        gcareadirector::setnearestmax(30);
        gcmodeldirector::setnearestmax(2);
        globalclass.bgmusic.changefilename("Root/Data/sounds/MUSICLEGOUNDERGROUND");
        globalclass.bgmusic.play(1);
        this.plataarray = [  ];
        var1 = new lego_volatileplatform("cla0", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla1", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla2", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla3", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla4", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla5", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla6", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla7", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla8", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("cla9", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("claa", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("clab", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("clac", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("clad", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("clae", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("claf", this.parent.name);
        this.plataarray.__append(var1);
        var1 = new lego_volatileplatform("clag", this.parent.name);
        this.plataarray.__append(var1);
        this.platbarray = [  ];
        var1 = new lego_volatileplatform("clb0", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb1", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb2", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb3", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb4", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb5", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb6", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb7", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb8", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clb9", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clba", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbb", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbc", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbd", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbe", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbf", this.parent.name);
        this.platbarray.__append(var1);
        var1 = new lego_volatileplatform("clbg", this.parent.name);
        this.platbarray.__append(var1);
        this.platcarray = [  ];
        var1 = new lego_volatileplatform("clc0", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc1", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc2", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc3", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc4", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc5", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc6", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc7", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc8", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clc9", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clca", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clcb", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clcc", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clcd", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clce", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clcf", this.parent.name);
        this.platcarray.__append(var1);
        var1 = new lego_volatileplatform("clcg", this.parent.name);
        this.platcarray.__append(var1);
        var2 = 0;
        while ((this.plataarray.__length - 1) >= var2) {
            this.plataarray[var2].initfull();
            this.plataarray[var2].settimetofall(5.0);
            this.plataarray[var2].setshakerotateintensity(1.5);
            this.platbarray[var2].initfull();
            this.platbarray[var2].settimetofall(5.0);
            this.platbarray[var2].setshakerotateintensity(0.0);
            this.platcarray[var2].initfull();
            this.platcarray[var2].settimetofall(5.0);
            this.platcarray[var2].setshakerotateintensity(0.0);
            this.plataarray[var2].show();
            this.platbarray[var2].show();
            this.platcarray[var2].show();
            var2 = var2 + 1;
        }
        return null;
    }
    
    method onevent(param1) {
        var var1;
        if (param1.eventid == 1) {
            if (param1.args[0] == scslosifoundation::stringtoidentifier("cnt1")) {
                var1 = 0;
                while ((this.plataarray.__length - 1) >= var1) {
                    if (param1.args[1] == this.plataarray[var1].id) {
                        this.plataarray[var1].touch();
                        this.platbarray[var1].touch();
                        this.platcarray[var1].touch();
                    }
                    var1 = var1 + 1;
                }
            }
        }
        else if (param1.eventid == 46) {
            gccollisionphysicsgroup::spinmask(1.2);
        }
        else if (param1.eventid == 27) {
            globalclass.player.actor.gotopos(this.parent.enterstartid, this.parent.enterlookid);
            globalclass.player.unkill();
            globalclass.player.actor.switchanimation(scslosifoundation::stringtoidentifier("o000"));
            globalclass.player.actor.setinputstate("ninp");
            this.parent.level.cam.setaimode(11);
            var1 = 0;
            while ((this.plataarray.__length - 1) >= var1) {
                this.plataarray[var1].reset();
                this.platbarray[var1].reset();
                this.platcarray[var1].reset();
                var1 = var1 + 1;
            }
            gccollisionphysicsgroup::toggletriggerboxentered(scslosifoundation::stringtoidentifier("tbl5"), 0);
        }
        else if (param1.eventid == 3) {
            if (param1.args[0] == scslosifoundation::stringtoidentifier("tbl5")) {
                globalclass.player.kill();
                gcstaticsoundsptrarray::playtablesound(1048);
                this.parent.level.cam.setaimode(7);
                globalclass.player.actor.setinputstate("none");
            }
        }
        return null;
    }
    
    method cleanupfull() {
        var var1;
        var var2;
        if (this.plataarray != null) {
            var1 = this.plataarray.__length - 1;
            var2 = 0;
            while (var1 >= var2) {
                this.plataarray[var1 - var2].cleanupfull();
                this.plataarray[var1 - var2] = null;
                var2 = var2 + 1;
            }
            this.plataarray = null;
        }
        if (this.platbarray != null) {
            var1 = this.platbarray.__length - 1;
            var2 = 0;
            while (var1 >= var2) {
                this.platbarray[var1 - var2].cleanupfull();
                this.platbarray[var1 - var2] = null;
                var2 = var2 + 1;
            }
            this.platbarray = null;
        }
        if (this.platcarray != null) {
            var1 = this.platcarray.__length - 1;
            var2 = 0;
            while (var1 >= var2) {
                this.platcarray[var1 - var2].cleanupfull();
                this.platcarray[var1 - var2] = null;
                var2 = var2 + 1;
            }
            this.platcarray = null;
        }
        return null;
    }
    
    method exit() {
        this.parent = null;
        return null;
    }
    
    method resetallplats() {
        var var1;
        var1 = 0;
        while ((this.plataarray.__length - 1) >= var1) {
            this.plataarray[var1].reset();
            this.platbarray[var1].reset();
            this.platcarray[var1].reset();
            var1 = var1 + 1;
        }
        return null;
    }
}