class vllg6_puzzle {
    property parent;
    property deadhives;
    property swrd;
    property upgradefruit2;
    property upgradefruit3;
    property upgradefruit2_shown;
    property upgradefruit3_shown;
    property wirlpool;
    property orientation;
    
    method vllg6_puzzle(param1) {
        this.parent = param1;
        return null;
    }
    
    method initfull() {
        var var1;
        gcmodeldirector::setnearestmax(5);
        gcareadirector::setnearestmax(10);
        gcareadirector::setfog(-4513246, 0 - 1.0, 0 - 900.0, 0.05);
        if (gcsaver::finditem(scslosifoundation::stringtoidentifier("swrd")) == 0) {
            this.swrd = new lego_pickup("swrd", 0, 3, "item", 9, 1);
            this.swrd.initfull();
            this.swrd.show();
        }
        this.deadhives = 0;
        if (gcsaver::isconditionset(1073741824)) {
            globalclass.player.unequip();
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vlgr"), 0);
            gccharacter::setkapura(var1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl01"), 0);
            gccharacter::settohunga(var1, rgba(255, 247, 0, 255), rgba(255, 247, 0, 255), scslosifoundation::stringtoidentifier("mk9a"));
            gccharacter::setorientation(var1, -108);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl02"), 0);
            gccharacter::settohunga(var1, rgba(255, 247, 0, 255), rgba(255, 247, 0, 255), scslosifoundation::stringtoidentifier("mk2a"));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl03"), 0);
            gccharacter::settohunga(var1, rgba(39, 39, 39, 255), rgba(39, 39, 39, 255), scslosifoundation::stringtoidentifier("mk1a"));
            gccharacter::setorientation(var1, 112);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl04"), 0);
            gccharacter::settohunga(var1, rgba(255, 0, 13, 255), rgba(255, 0, 13, 255), scslosifoundation::stringtoidentifier("mk4a"));
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d003"), -1);
            gccharacter::setorientation(var1, -49);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl05"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk8a"));
            gccharacter::setorientation(var1, 13);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl05"), 0), rgba(255, 247, 0, 255), rgba(255, 0, 13, 255), rgba(39, 39, 39, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl06"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mkca"));
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl06"), 0), rgba(255, 0, 13, 255), rgba(255, 247, 0, 255), rgba(39, 39, 39, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl07"), 0);
            gccharacter::settohunga(var1, rgba(39, 39, 39, 255), rgba(255, 92, 1, 255), scslosifoundation::stringtoidentifier("mk3a"));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl08"), 0);
            gccharacter::settohunga(var1, rgba(255, 0, 13, 255), rgba(255, 0, 13, 255), scslosifoundation::stringtoidentifier("mk2a"));
            gccharacter::setorientation(var1, -147);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d003"), -1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl09"), 0);
            gccharacter::settohunga(var1, rgba(255, 247, 0, 255), rgba(255, 247, 0, 255), scslosifoundation::stringtoidentifier("mk6a"));
            gccharacter::setorientation(var1, -29);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl10"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk4a"));
            gccharacter::setorientation(var1, -42);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl10"), 0), rgba(0, 208, 33, 255), rgba(0, 208, 33, 255), rgba(102, 0, 102, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl11"), 0);
            gccharacter::settohunga(var1, rgba(255, 247, 0, 255), rgba(255, 247, 0, 255), scslosifoundation::stringtoidentifier("mkaa"));
            gccharacter::setorientation(var1, 100);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
            gccharacter::addpart(var1, "vl11/pfrk", 1);
            gccharacter::addpart(var1, "vl11/shld", 2);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl12"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk7a"));
            gccharacter::setorientation(var1, -179);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
            gccharacter::addpart(var1, "vl12/pfrk", 1);
            gccharacter::addpart(var1, "vl12/shld", 2);
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl12"), 0), rgba(255, 0, 13, 255), rgba(255, 0, 13, 255), rgba(255, 247, 0, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl13"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk0a"));
            gccharacter::setorientation(var1, -4);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl13"), 0), rgba(39, 39, 39, 255), rgba(255, 0, 13, 255), rgba(255, 92, 1, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl14"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk1a"));
            gccharacter::setorientation(var1, -7);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl14"), 0), rgba(255, 0, 13, 255), rgba(255, 247, 0, 255), rgba(39, 39, 39, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl15"), 0);
            gccharacter::settohunga(var1, rgba(255, 0, 13, 255), rgba(39, 39, 39, 0), scslosifoundation::stringtoidentifier("mk6a"));
            gccharacter::setorientation(var1, 7);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("hak6"), -1);
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl16"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mk4a"));
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl16"), 0), rgba(39, 39, 39, 255), rgba(255, 247, 0, 255), rgba(39, 39, 39, 255));
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl17"), 0);
            gccharacter::settohunga(var1, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0), scslosifoundation::stringtoidentifier("mkba"));
            gccharacter::setcolors(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl17"), 0), rgba(255, 247, 0, 255), rgba(255, 247, 0, 255), rgba(255, 247, 0, 255));
            gcareadirector::hide(scslosifoundation::stringtoidentifier("fhv0"), gcareadirector::getcurrentarea());
            gcareadirector::hide(scslosifoundation::stringtoidentifier("fhv1"), gcareadirector::getcurrentarea());
            gcareadirector::hide(scslosifoundation::stringtoidentifier("fhv2"), gcareadirector::getcurrentarea());
            gcareadirector::hide(scslosifoundation::stringtoidentifier("fhv3"), gcareadirector::getcurrentarea());
            gcareadirector::hide(scslosifoundation::stringtoidentifier("door"), gcareadirector::getcurrentarea());
            globalclass.bgmusic.changefilename("Root/Data/sounds/MusicVillage");
            globalclass.bgmusic.play(1);
        }
        else {
            globalclass.player.equipcombat();
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vlgr"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl01"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl02"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl03"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl04"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl05"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl06"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl07"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl08"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl09"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl10"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl11"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl12"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl13"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl14"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl15"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl16"), 0);
            gcmodeldirector::hide(scslosifoundation::stringtoidentifier("vl17"), 0);
            globalclass.bgmusic.changefilename("Root/Data/sounds/MUSICtahuTheme");
            globalclass.bgmusic.play(1);
        }
        this.upgradefruit2_shown = gcsaver::finditem(scslosifoundation::stringtoidentifier("fru0"));
        if (this.upgradefruit2_shown == 0) {
            this.upgradefruit2 = new lego_pickup("fru0", 0, 6, "frut", 1, 1);
            this.upgradefruit2.initfull();
        }
        this.upgradefruit3_shown = gcsaver::finditem(scslosifoundation::stringtoidentifier("fru1"));
        if (this.upgradefruit3_shown == 0) {
            this.upgradefruit3 = new lego_pickup("fru1", 0, 6, "frut", 1, 1);
            this.upgradefruit3.initfull();
        }
        if (bettersaver::getbooleanvalue(48)) {
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl04"), 0);
            gccharacter::settohunga(var1, rgba(255, 0, 13, 255), rgba(255, 0, 13, 255), scslosifoundation::stringtoidentifier("mk4a"));
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
            gccharacter::setorientation(var1, -49);
        }
        if (bettersaver::getbooleanvalue(49)) {
            var1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("vl08"), 0);
            gccharacter::settohunga(var1, rgba(255, 0, 13, 255), rgba(255, 0, 13, 255), scslosifoundation::stringtoidentifier("mk2a"));
            gccharacter::setorientation(var1, -147);
            gccharacter::setinputstate(var1, scslosifoundation::stringtoidentifier("none"));
            gccharacter::switchanimation(var1, scslosifoundation::stringtoidentifier("d000"), -1);
        }
        if (bettersaver::getbooleanvalue(63)) {
            gccollisionphysicsgroup::togglepickuponoff(scslosifoundation::stringtoidentifier("ar00"), 0);
            gcnolightdirector::hide(scslosifoundation::stringtoidentifier("ar00"), gcareadirector::getcurrentarea());
        }
        this.wirlpool = new lego_moveableobject("vtcr");
        this.wirlpool.initfull();
        this.wirlpool.settweakable();
        this.orientation = 1;
        return null;
    }
    
    method cleanupfull() {
        if (this.swrd != null) {
            this.swrd.cleanupfull();
            this.swrd = null;
        }
        if (this.upgradefruit2 != null) {
            this.upgradefruit2.cleanupfull();
            this.upgradefruit2 = null;
        }
        if (this.upgradefruit3 != null) {
            this.upgradefruit3.cleanupfull();
            this.upgradefruit3 = null;
        }
        if (this.wirlpool != null) {
            this.wirlpool.cleanupfull();
            this.wirlpool = null;
        }
        return null;
    }
    
    method exit() {
        this.parent = null;
        return null;
    }
    
    method process(param1) {
        this.rotatecrystal();
        return null;
    }
    
    method onevent(param1) {
        if (param1.eventid == 51) {
            if (param1.args[1] == 1) {
                this.deadhives = this.deadhives + 1;
                if (this.deadhives == 4) {
                    gcsaver::setcondition(1073741824, 1);
                    gcareadirector::hide(scslosifoundation::stringtoidentifier("door"), scslosifoundation::stringtoidentifier("vllg"));
                    globalclass.bgmusic.changefilename("Root/Data/sounds/MusicVillage");
                    globalclass.bgmusic.play(1);
                }
            }
        }
        else if (param1.eventid == 46) {
            gccollisionphysicsgroup::spinmask(1.2);
        }
        else if (param1.eventid == 27) {
            globalclass.level.cam.setaimode(11);
            globalclass.player.actor.gotopos(this.parent.enterstartid, this.parent.enterlookid);
            globalclass.player.unkill();
            globalclass.player.actor.switchanimation(scslosifoundation::stringtoidentifier("t000"));
            globalclass.player.actor.setinputstate("ninp");
        }
        else if (param1.eventid == 41) {
            if (bettersaver::getbooleanvalue(48)) {
                this.give_fruit2();
            }
            if (bettersaver::getbooleanvalue(49)) {
                this.give_fruit3();
            }
        }
        return null;
    }
    
    method input(param1) {
        return null;
    }
    
    method give_fruit2() {
        if (this.upgradefruit2_shown == 0) {
            this.upgradefruit2.obj.setpos(-77.66334, 1.173774, 9.055604);
            gcstaticsoundsptrarray::playtablesound(1032);
            this.upgradefruit2_shown = 1;
        }
        return null;
    }
    
    method give_fruit3() {
        if (this.upgradefruit3_shown == 0) {
            this.upgradefruit3.obj.setpos(-127.735626, -3.61725, 125.51088);
            gcstaticsoundsptrarray::playtablesound(1032);
            this.upgradefruit3_shown = 1;
        }
        return null;
    }
    
    method rotatecrystal() {
        if (this.orientation > 359) {
            this.orientation = 0;
        }
        else {
            this.orientation = this.orientation + 1;
        }
        this.wirlpool.setorientation(0.0, this.orientation, 0.0);
        return null;
    }
}