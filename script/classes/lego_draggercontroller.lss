class lego_draggercontroller {
property dragger;
property xtarget;
property ytarget;
property ztarget;
property charx;
property chary;
property charz;
property spritex;
property spritey;
property spritez;
property chardir;
property sprite;
property active;

    method lego_draggercontroller() {
        return null;
    }

    method initfull() {       
        return null;
    }

    method cleanupfull() {
        return null;
    }

    method onevent(param1) {
        return null;
    }    
    
    method process(param1) {
        if (this.active == 1) {
            this.spritex = (this.spritex + this.xtarget);
            this.spritey = (this.spritey + this.ytarget);
            this.spritez = (this.spritez + this.ztarget);
            this.dragger.process();
            this.dragger.setpos(this.spritex, (this.spritey + 4), this.spritez);
        }
        return null;
    }

    method input(param1) {
        if ((param1.event == 2) && (param1.button == 231)) {
            if (this.active == 1) {
                this.active = 0;
                this.dragger.hide();
                this.dragger.remove();
                this.dragger.cleanupfull();                
                debug::print("Active = " + (__tostring(this.active)) + ". Removing Dragger!");
            }
            if (this.active != 1) {
                this.active = 1;
                this.getcoords();
                this.draggersprite();
                this.dragger = new gs_lego_animatebigsprite(this.sprite, 0, 12, 1, this.charx, this.chary, this.charz, 1, 1);
                this.dragger.initfull();
                this.dragger.add();
                this.dragger.show();
                this.dragger.animloop(0, 1);
                this.dragger.startanimate();             
                debug::print("Active = " + (__tostring(this.active)) + ". Spawning Dragger!");
            }

        }
    }

    method draggersprite() {
        if (globalclass.player.actorid == "onua") {
            this.sprite = "Root/Data/Art/CLAW";
        }        
        else if (globalclass.player.actorid == "gali") {
            this.sprite = "Root/Data/Art/HOOK";
        }        
        else if (globalclass.player.actorid == "poha") {
            this.sprite = "Root/Data/Art/HAND";
        }        
        else if (globalclass.player.actorid == "kopa") {
            this.sprite = "Root/Data/Art/SWRD";
        }        
        else if (globalclass.player.actorid == "lewa") {
            this.sprite = "Root/Data/Art/AXE";
        }        
        else if (globalclass.player.actorid == "tahu") {
            this.sprite = "Root/Data/Art/SWORD";
        }        
        else if (globalclass.player.actorid == "nbua") {
            this.sprite = "Root/Data/Art/DISK";
        }
        return null;
    }

    method getcoords() {
        //Get camera orientation
        this.xtarget = gclegocamera::getforwardx(gcviewport::getcamera(gcgame::getmainview()));
        this.ytarget = gclegocamera::getforwardy(gcviewport::getcamera(gcgame::getmainview()));       
        this.ztarget = gclegocamera::getforwardz(gcviewport::getcamera(gcgame::getmainview()));

        //Get character position
        this.charx = gccharacter::getpositionx(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        this.chary = gccharacter::getpositiony(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        this.charz = gccharacter::getpositionz(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        this.chardir = gccharacter::getorientation(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));

        //Set initial sprite position values
        this.spritex = (this.charx);
        this.spritey = (this.chary);
        this.spritez = (this.charz);

        //gccharacter::setvelocity(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")), (90 * xtarget), (90 * ytarget), (90 * ztarget));

        debug::print("CamX = " + __tostring(this.xtarget));
        debug::print("CamY = " + __tostring(this.ytarget));
        debug::print("CamZ = " + __tostring(this.ztarget));        
        debug::print("CharX = " + __tostring(this.charx));
        debug::print("CharY = " + __tostring(this.chary));
        debug::print("CharZ = " + __tostring(this.charz));
        debug::print("CharDir = " + __tostring(this.chardir));
        return null;
    }
}