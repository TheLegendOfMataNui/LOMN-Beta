class sfox_puzzle {
    property parent;
    property buzzyboi;
    property buzzyboicontrol;
    
    method sfox_puzzle(param1) {
        this.parent = param1;
        return null;
    }
    
    method initfull() {
        globalclass.bgmusic.changefilename("Root/Data/sounds/MUSICTechnoSnowboardPart2");
        globalclass.bgmusic.play(1);

        // Set camera positioning
        globalclass.level.cam.setcamzoomfactor(9.0);
        globalclass.level.cam.setheightoffset(2.0);       
        globalclass.player.maskcontrol.usemasks(0);

        var ramacount = 0;
        var rama = [ 
           gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("dfly")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df01")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df02")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df03")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df04")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df05")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df06")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df07")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df08")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df09")),      
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df10")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df11")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df12")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df13")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df14")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df15")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df16")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df17")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df18")),
            gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("df19")) ];

        while ((rama.__length - 1) >= ramacount) {
            gccharacter::aisetbenign(rama[ramacount], 1);
            ramacount = ramacount + 1;
        }

        this.buzzyboi = new gs_lego_character("crma", "rama", this.parent.name, 0, 0, 0, 0, "aiin");
        this.buzzyboi.initfull();
        this.buzzyboi.add();
        this.buzzyboi.show();
        this.buzzyboicontrol = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("crma"));

        gccharacter::aidisabledefault(this.buzzyboicontrol);
        gccharacter::deactivateattackcollisions(this.buzzyboicontrol);
        gccharacter::disableallraycollisions(this.buzzyboicontrol);
        gccharacter::setignoreallcollisions(this.buzzyboicontrol, 1);
        return null;
    }

    method cleanupfull() {
        if (this.buzzyboi != null) {
            this.buzzyboi.cleanupfull();
            this.buzzyboi = null;
        }
        if (this.buzzyboicontrol != null) {
            this.buzzyboicontrol = null;
        }
        return null;
    }
    
    method exit() {
        this.parent = null;
        return null;
    }
    
    method process(param1) {
        return null;
    }
    
    method onevent(param1) {
        this.windfly();
        return null;
    }
    
    method input(param1) {
        return null;
    }

    method windfly() {     
        var xtarget = gclegocamera::getforwardx(gcviewport::getcamera(gcgame::getmainview()));
        var ytarget = gclegocamera::getforwardy(gcviewport::getcamera(gcgame::getmainview()));       
        var ztarget = gclegocamera::getforwardz(gcviewport::getcamera(gcgame::getmainview()));  
        
        var lewax = gccharacter::getpositionx(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        var leway = gccharacter::getpositiony(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        var lewaz = gccharacter::getpositionz(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));
        var lewadir = gccharacter::getorientation(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")));

        gccharacter::setvelocity(gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("cnt1")), (90 * xtarget), (90 * ytarget), (90 * ztarget));

        if ((gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("crma"))) != null) {
            gccharacter::setposition(this.buzzyboicontrol, (lewax), (leway +6), lewaz);
            gccharacter::setorientation(this.buzzyboicontrol, lewadir);
        }

        globalclass.player.maskcontrol.changemask(10);
        return null;
    }
}