class puzzle_man3 {
    property parent;
    property bridge;
    
    method puzzle_man3(param1) {
        this.parent = param1;
        return null;
    }
    
    method initfull(param1) {
        var var1;
        var var2;
        var akamai;
        var mana1;
        var mana2;
        var mana3;
        var mana4;
        var mana5;
        var mana6;
        var mana7;
        globalclass.bgmusic.changefilename("Root/Data/sounds/Musiclowandcreepyambience");
        globalclass.bgmusic.play();				
        if (globalclass.player.actorid != "wair") {
            globalclass.player.changetoa("wair");
            gccollisionphysicsgroup::settoaposition(scslosifoundation::stringtoidentifier("str0"), scslosifoundation::stringtoidentifier("lok0"));
        }
        this.bridge = [
            new lego_volatileplatform("prt1"),
            new lego_volatileplatform("prt2"),
            new lego_volatileplatform("prt3"),
            new lego_volatileplatform("prt4"),
            new lego_volatileplatform("prt5") ];
        var2 = 0;
        while ((this.bridge.__length - 1) >= var2) {
            this.bridge[var2].initfull();
            this.bridge[var2].settimetofall(1.2);
            this.bridge[var2].setshakebobbleintensity(1.2);
            this.bridge[var2].show();
            var2 = var2 + 1;
        }
        akamai = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("akam"), 0);
        gccharacter::setinputstate(akamai, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(akamai, scslosifoundation::stringtoidentifier("ak00"), -1);
        gccharacter::setorientation(akamai, 45);
        gccharacter::addpart(akamai, "akam/mk8a", 1);

        mana1 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1mns"), 0);
        gccharacter::setinputstate(mana1, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana1, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana1, -198);        
        
        mana2 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m01"), 0);
        gccharacter::setinputstate(mana2, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana2, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana2, -153);

        mana3 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m02"), 0);
        gccharacter::setinputstate(mana3, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana3, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana3, -185);

        mana4 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m03"), 0);
        gccharacter::setinputstate(mana4, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana4, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana4, -172);

        mana5 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m04"), 0);
        gccharacter::setinputstate(mana5, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana5, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana5, -169);

        mana6 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m05"), 0);
        gccharacter::setinputstate(mana6, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana6, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana6, -194);

        mana7 = gcmodeldirector::getcharacter(scslosifoundation::stringtoidentifier("1m06"), 0);
        gccharacter::setinputstate(mana7, scslosifoundation::stringtoidentifier("none"));
        gccharacter::switchanimation(mana7, scslosifoundation::stringtoidentifier("1m00"), -1);
        gccharacter::setorientation(mana7, -174);
        return null;
    }
    
    method cleanupfull() {
        var var1;
        var var2;
        if (this.bridge != null) {
            var1 = this.bridge.__length - 1;
            var2 = 0;
            while (var1 >= var2) {
                this.bridge[var1 - var2].cleanupfull();
                this.bridge[var1 - var2] = null;
                var2 = var2 + 1;
            }
            this.bridge = null;
        }
        return null;
    }

    method exit() {
        this.parent = null;
        return null;
    }
    
    method onevent(param1) {
        var var1;
        if (param1.eventid == 4) {
            if (param1.args[0] == scslosifoundation::stringtoidentifier("cine")) {
                globalclass.bgmusic.stop();
                gchuddirector::playcinematic("Root/Data/cinematics/ToaKaitaFight.bik", 1);
                gcbagroup::setswitchareas(scslosifoundation::stringtoidentifier("onua"), scslosifoundation::stringtoidentifier("str0"), scslosifoundation::stringtoidentifier("lok0"));
            }
        }
        else if (param1.eventid == 3) {
            if (param1.args[0] == scslosifoundation::stringtoidentifier("tb00")) {
                globalclass.player.kill();
                gcstaticsoundsptrarray::playtablesound(1048);
                this.parent.level.cam.setaimode(7);
                globalclass.player.actor.setinputstate("none");
            }
        }
        else if (param1.eventid == 46) {
            gccollisionphysicsgroup::spinmask(1.2);
        }
        else if (param1.eventid == 27) {
            globalclass.player.actor.gotopos(this.parent.enterstartid, this.parent.enterlookid);
            globalclass.player.unkill();
            globalclass.player.actor.setinputstate("ninp");
            this.parent.level.cam.setaimode(11);
            gccollisionphysicsgroup::toggletriggerboxentered(scslosifoundation::stringtoidentifier("tb00"), 0);
            globalclass.player.actor.switchanimation(scslosifoundation::stringtoidentifier("wa00"));
            var1 = 0;
            while ((this.bridge.__length - 1) >= var1) {
                this.bridge[var1].reset();
                var1 = var1 + 1;
            }
        }
        if (!(this.bridge == null)) {
            var1 = 0;
            while ((this.bridge.__length - 1) >= var1) {
                this.bridge[var1].onevent(param1);
                var1 = var1 + 1;
            }
        }
        return null;
    }
}